# Decorators (装饰器)
装饰器是一项实验性特性，在未来的版本中可能会发生改变

装饰器是一种特殊类型的声明，它能够被附加到类声明，方法，访问符，属性或参数上。 装饰器使用@expression这种形式，expression求值后必须为一个函数，它会在运行时被调用，被装饰的声明信息做为参数传入


### tsconfig.json
若要启用实验性的装饰器特性，你必须在命令行或tsconfig.json里启用experimentalDecorators编译器选项
```typescript
{
    "compilerOptions": {
        "target": "ES5",
        "experimentalDecorators": true
    }
}
```


### 命令行
```typescript
tsc --target ES5 --experimentalDecorators
```


### 装饰器工厂
装饰器工厂就是一个简单的函数，它返回一个表达式，以供装饰器在运行时调用
```typescript
function color(value: string) { // 这是一个装饰器工厂
    return function (target) { //  这是装饰器
    }
}
```


### 装饰器组合
多个装饰器可以同时应用到一个声明上

当多个装饰器应用于一个声明上，它们求值方式与复合函数相似

在TypeScript里，当多个装饰器应用在一个声明上时会进行如下步骤的操作
* 由上至下依次对装饰器表达式求值
* 求值的结果会被当作函数，由下至上依次调用
```typescript
// 同行
@f @g x
// 多行
@f 
@g 
x
```


### 装饰器求值
类中不同声明上的装饰器将按以下规定的顺序应用
* 参数装饰器，然后依次是方法装饰器，访问符装饰器，或属性装饰器应用到每个实例成员
* 参数装饰器，然后依次是方法装饰器，访问符装饰器，或属性装饰器应用到每个静态成员
* 参数装饰器应用到构造函数
* 类装饰器应用到类


### 类装饰器
类装饰器在类声明之前被声明(紧靠着类声明)

类装饰器应用于类构造函数，可以用来监视，修改或替换类定义

类装饰器不能用在声明文件中(.d.ts)，也不能用在任何外部上下文中(比如declare的类)

类装饰器表达式会在运行时当作函数被调用，类的构造函数作为其唯一的参数

如果类装饰器返回一个值，它会使用提供的构造函数来替换类的声明


### 方法装饰器
方法装饰器声明在一个方法的声明之前(紧靠着方法声明)

它会被应用到方法的属性描述符上，可以用来监视，修改或者替换方法定义

方法装饰器不能用在声明文件(.d.ts)，重载或者任何外部上下文(比如declare的类)中

方法装饰器表达式会在运行时当作函数被调用，传入下列3个参数
* 对于静态成员来说是类的构造函数，对于实例成员是类的原型对象
* 成员的名字
* 成员的属性描述符

如果方法装饰器返回一个值，它会被用作方法的属性描述符


### 访问器装饰器
访问器装饰器声明在一个访问器的声明之前(紧靠着访问器声明)

访问器装饰器应用于访问器的属性描述符并且可以用来监视，修改或替换一个访问器的定义

访问器装饰器不能用在声明文件中(.d.ts)，或者任何外部上下文(比如declare的类)里

TypeScript不允许同时装饰一个成员的get和set访问器。一个成员的所有装饰的必须应用在文档顺序的第一个访问器上。这是因为，在装饰器应用于一个属性描述符时，它联合了get和set访问器，而不是分开声明的

访问器装饰器表达式会在运行时当作函数被调用，传入下列3个参数
* 对于静态成员来说是类的构造函数，对于实例成员是类的原型对象
* 成员的名字
* 成员的属性描述符


### 属性装饰器
属性装饰器声明在一个属性声明之前(紧靠着属性声明)

属性装饰器不能用在声明文件中(.d.ts)，或者任何外部上下文(比如declare的类)里

属性装饰器表达式会在运行时当作函数被调用，传入下列2个参数
* 对于静态成员来说是类的构造函数，对于实例成员是类的原型对象
* 成员的名字


### 参数装饰器
参数装饰器声明在一个参数声明之前(紧靠着参数声明)

参数装饰器应用于类构造函数或方法声明

参数装饰器不能用在声明文件(.d.ts)，重载或其它外部上下文(比如declare的类)里

参数装饰器表达式会在运行时当作函数被调用，传入下列3个参数
* 对于静态成员来说是类的构造函数，对于实例成员是类的原型对象
* 成员的名字
* 参数在函数参数列表中的索引****

参数装饰器只能用来监视一个方法的参数是否被传入。参数装饰器的返回值会被忽略




